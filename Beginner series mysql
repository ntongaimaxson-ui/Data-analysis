SELECT *
FROM parks_and_recreation. employee_demographics;

SELECT first_name,
last_name,
age,
age + 10
FROM parks_and_recreation. employee_demographics;

#PEMDAS

SELECT DISTINCT first_name, gender
FROM parks_and_recreation.employee_demographics;

SELECT *
FROM parks_and_recreation.employee_salary
WHERE first_name = 'Leslie'
;

SELECT *
FROM parks_and_recreation.employee_salary
;
SELECT *
FROM employee_salary
WHERE salary >= 50000
;
SELECT *
FROM parks_and_recreation.employee_demographics
WHERE birth_date > '1985-01-01'
AND gender = 'male'
;


SELECT *
FROM parks_and_recreation. employee_demographics;
;
SELECT gender, AVG(age)
FROM parks_and_recreation.employee_demographics
group by gender
;

SELECT gender, AVG(age), MAX(age), MIN(age), COUNT(age)
FROM parks_and_recreation.employee_demographics
group by gender
;

SELECT *
FROM parks_and_recreation.employee_salary
Order by salary DESC;

SELECT *
FROM parks_and_recreation.employee_demographics
ORDER BY age DESC
LIMIT 3

-- aliasing
;
SELECT*
FROM employee_demographics;
GROUP BY gender
Having AVG(age) >40;

SELECT *
FROM employee_demographics
INNER JOIN employee_salary
	ON employee_demographics.employee_id = employee_salary.employee_id
;

SELECT *
FROM employee_salary emp1
JOIN employee_salary emp2
	ON emp1.employee_id + 1 = emp2.employee_id
;
SELECT *
FROM parks_and_recreation.parks_departments

Unions
;
SELECT age, gender
FROM employee_demographics
UNION
SELECT first_name, last_name
FROM employee_salary;


SELECT first_name, last_name, 'Old'
FROM employee_demographics
WHERE age > 50;

--- String Functions

SELECT LENGTH("SKYFALL");

SELECT first_name, LENGTH(first_name)
FROM employee_demographics
;
SELECT*, UPPER(first_name)
FROM employee_demographics;

SELECT first_name, REPLACE ( first_name, 'a' , 'b' )
FROM employee_demographics
;
SELECT first_name, last_name,
CONCAT(first_name,last_name)
FROM employee_demographics;

SELECT first_name, last_name,
CONCAT(first_name,'  ', last_name) AS 'Full Names'
FROM employee_demographics;

--- Case Statements

Select first_name,
last_name,
age,
CASE
	WHEN age <= 40 THEN 'Young' 
    WHEN age between 40 and 50 THEN 'Old'
    WHEN age >50 THEN 'Shosho'
END AS age_bracket
FROM employee_demographics;

Select employee_id,
first_name,
occupation,
salary,
salary+ 1200 AS 'New Salary'
FROM employee_salary;

-- Pay increase and Bonus
-- < 50,000 = 5%
-- > 50,000 = 7%
-- Finance = 10%

Select employee_id,
first_name,
occupation,
salary,
CASE WHEN salary <50000 THEN salary+ (salary* 0.05)
	WHEN salary > 50000 THEN salary + (salary*0.07)
END AS New_salary
FROM employee_salary;

SELECT*
FROM employee_demographics
WHERE employee_id IN
				(SELECT employee_id
					FROM employee_salary
                    WHERE dept_id = 1);
                    

SELECT first_name, occupation, salary,
(SELECT AVG (salary)
FROM employee_salary)
FROM employee_salary;


SELECT gender, AVG (age), MAX (age), MIN (age), COUNT (age)
FROM parks_and_recreation, employee_demographics
GROUP BY gender;

Window functions;

Select gender, AVG (salary) as average_salary
FROM employee_demographics dem
JOIN employee_salary sal
	ON dem.employee_id = sal.employee_id
GROUP BY gender;


Select gender, AVG (salary) OVER ()
FROM employee_demographics dem
JOIN employee_salary sal
	ON dem.employee_id = sal.employee_id;

Select gender, AVG (salary) OVER (PARTITION BY gender)
FROM employee_demographics dem
JOIN employee_salary sal
	ON dem.employee_id = sal.employee_id;

Select dem.first_name, dem.last_name, gender, AVG (salary) OVER (PARTITION BY gender)
FROM employee_demographics dem
JOIN employee_salary sal
	ON dem.employee_id = sal.employee_id;
    
Select dem.first_name, dem.last_name, dem.gender,
SUM(salary) OVER (PARTITION BY gender)
FROM employee_demographics dem
JOIN employee_salary sal
	ON dem.employee_id = sal.employee_id;

Select dem.first_name, dem.last_name, dem.gender,
SUM(salary) OVER (PARTITION BY gender ORDER BY dem.employee_id) AS rollin_total
FROM employee_demographics dem
JOIN employee_salary sal
	ON dem.employee_id = sal.employee_id;

Select dem.employee_id, dem.first_name, dem.last_name, dem.gender,
ROW_NUMBER () OVER ()
FROM employee_demographics dem
JOIN employee_salary sal
	ON dem.employee_id = sal.employee_id;
    
Select dem.employee_id, dem.first_name, dem.last_name, dem.gender, salary,
ROW_NUMBER () OVER (PARTITION BY gender ORDER BY salary DESC)
FROM employee_demographics dem
JOIN employee_salary sal
	ON dem.employee_id = sal.employee_id;

Select dem.employee_id, dem.first_name, dem.last_name, dem.gender, salary,
ROW_NUMBER () OVER (PARTITION BY gender ORDER BY salary DESC),
RANK () OVER (PARTITION BY gender ORDER BY salary DESC) AS rank_num 
FROM employee_demographics dem
JOIN employee_salary sal
	ON dem.employee_id = sal.employee_id;
    
RANK AND DENSE RANK;

ADVANCED MYSQL SERIES;
------ CTEs
;

WITH CTE_Example (gender, Avg_Sal, Max_Sal, Min_Sal, COUNT_Sal) AS
(
Select gender, AVG (salary) avg_sal, MAX(salary), MIN(salary), COUNT(salary)
FROM parks_and_recreation.employee_demographics dem
JOIN employee_salary sal
	ON dem.employee_id = sal.employee_id
GROUP BY gender
)
SELECT*
FROM CTE_Example
;

WITH CTE_Example AS
(
SELECT employee_id, gender, birth_date
FROM parks_and_recreation.employee_demographics
WHERE birth_date > '1985-01-01'
),
CTE_Example2 AS
(
SELECT employee_id, salary
FROM parks_and_recreation.employee_salary
WHERE salary > 50000
)
SELECT*
FROM CTE_Example 
JOIN CTE_Example2
	ON CTE_example.employee_id=CTE_Example2.employee_id;
    
SELECT employee_id, AVG(avg_salary)
FROM parks_and_recreation.employee_salary
GROUP BY gender;

-- TEMPORARY TABLES
;

CREATE TEMPORARY TABLE temp_table
(first_name varchar(50),
last_name varchar(50),
favorite_movie varchar(100)
)

SELECT *
FROM temp_table;

INSERT INTO temp_table
VALUES( 'Baelish' , 'Littlefinger' , 'Game of Thrones: The Two Towers');

SELECT *
FROM temp_table;
;

CREATE TEMPORARY TABLE salary_over_50k
SELECT *
FROM employee_salary
WHERE salary >=50000;


SELECT *
FROM salary_over_50k;


-- stored procedures



